1684200500069-0
message
{'key': {'key': 'transaction:1'}, 'before': {}, 'after': {'id': '1', 'last_4_cc_digits': '4321', 'status': 'authorized', 'city': 'new_york', 'user_id': '1', 'value': 'abc', 'currency_id': 'USD'}, 'connector': 'rdi_write_behind', 'server_name': None, 'db': '', 'schema': '', 'table': None, 'keyspace': 'transaction:*', 'opcode': 'u', 'metadata': {'stream': 'data:transaction:{06S}', 'stream_time': '1684200499566-0', 'collector_record': {'key': '{"key":"transaction:1"}', 'value': '{"before":{},"after":{"id":"1","last_4_cc_digits":"4321","status":"authorized","city":"new_york","user_id":"1","value":"abc","currency_id":"USD"},"op":"u","source":{"connector":"rdi_write_behind","ts_ms":1684200499566,"command":"HSET","keyspace":"transaction:*"}}'}, 'collector_time': None, 'parse_time': 0.053466796875, 'source_time': 1684200499566}, 'commands': [], 'results': [], 'job_name': 'e_transactions', 'transform_time': None, 'execution_time': None, '_parsed_key': {'key': 'transaction:1'}, '_parsed_metadata_fields': None, 'reason_rejected': 'rejected by output writer: (pymssql._pymssql.OperationalError) (245, b"Conversion failed when converting the nvarchar value \'abc\' to data type int.DB-Lib error message 20018, severity 16:\\nGeneral SQL Server error: Check messages from the SQL Server\\n")\n[SQL: \n                    MERGE [dbo].[e_transactions] AS target\n                    USING (VALUES (%(id)s)) AS source ([id]) ON (target.[id] = source.[id])\n                    WHEN NOT MATCHED BY target THEN INSERT ([id], [city], [value], [user_id], [currency_id], [status], [last_4_cc_digits]) VALUES (%(id)s, %(city)s, %(value)s, %(user_id)s, %(currency_id)s, %(status)s, %(last_4_cc_digits)s)\n                    WHEN MATCHED THEN UPDATE SET target.[city] = %(city)s, target.[value] = %(value)s, target.[user_id] = %(user_id)s, target.[currency_id] = %(currency_id)s, target.[status] = %(status)s, target.[last_4_cc_digits] = %(last_4_cc_digits)s;\n                    ]\n[parameters: {\'id\': \'1\', \'city\': \'new_york\', \'value\': \'abc\', \'user_id\': \'1\', \'currency_id\': \'USD\', \'status\': \'authorized\', \'last_4_cc_digits\': \'4321\'}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)', 'filtered': False}
1684200500069-0
message
{'key': {'key': 'transaction:1'}, 'before': {}, 'after': {'id': '1', 'last_4_cc_digits': '4321', 'status': 'authorized', 'city': 'new_york', 'user_id': '1', 'value': 'abc', 'currency_id': 'USD'}, 'connector': 'rdi_write_behind', 'server_name': None, 'db': '', 'schema': '', 'table': None, 'keyspace': 'transaction:*', 'opcode': 'u', 'metadata': {'stream': 'data:transaction:{06S}', 'stream_time': '1684200499566-0', 'collector_record': {'key': '{"key":"transaction:1"}', 'value': '{"before":{},"after":{"id":"1","last_4_cc_digits":"4321","status":"authorized","city":"new_york","user_id":"1","value":"abc","currency_id":"USD"},"op":"u","source":{"connector":"rdi_write_behind","ts_ms":1684200499566,"command":"HSET","keyspace":"transaction:*"}}'}, 'collector_time': None, 'parse_time': 0.053466796875, 'source_time': 1684200499566}, 'commands': [], 'results': [], 'job_name': 'e_transactions', 'transform_time': None, 'execution_time': None, '_parsed_key': {'key': 'transaction:1'}, '_parsed_metadata_fields': None, 'reason_rejected': 'rejected by output writer: (pymssql._pymssql.OperationalError) (245, b"Conversion failed when converting the nvarchar value \'abc\' to data type int.DB-Lib error message 20018, severity 16:\\nGeneral SQL Server error: Check messages from the SQL Server\\n")\n[SQL: \n                    MERGE [dbo].[e_transactions] AS target\n                    USING (VALUES (%(id)s)) AS source ([id]) ON (target.[id] = source.[id])\n                    WHEN NOT MATCHED BY target THEN INSERT ([id], [city], [value], [user_id], [currency_id], [status], [last_4_cc_digits]) VALUES (%(id)s, %(city)s, %(value)s, %(user_id)s, %(currency_id)s, %(status)s, %(last_4_cc_digits)s)\n                    WHEN MATCHED THEN UPDATE SET target.[city] = %(city)s, target.[value] = %(value)s, target.[user_id] = %(user_id)s, target.[currency_id] = %(currency_id)s, target.[status] = %(status)s, target.[last_4_cc_digits] = %(last_4_cc_digits)s;\n                    ]\n[parameters: {\'id\': \'1\', \'city\': \'new_york\', \'value\': \'abc\', \'user_id\': \'1\', \'currency_id\': \'USD\', \'status\': \'authorized\', \'last_4_cc_digits\': \'4321\'}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)', 'filtered': False}
1684200500069-0
message
{'key': {'key': 'transaction:1'}, 'before': {}, 'after': {'id': '1', 'last_4_cc_digits': '4321', 'status': 'authorized', 'city': 'new_york', 'user_id': '1', 'value': 'abc', 'currency_id': 'USD'}, 'connector': 'rdi_write_behind', 'server_name': None, 'db': '', 'schema': '', 'table': None, 'keyspace': 'transaction:*', 'opcode': 'u', 'metadata': {'stream': 'data:transaction:{06S}', 'stream_time': '1684200499566-0', 'collector_record': {'key': '{"key":"transaction:1"}', 'value': '{"before":{},"after":{"id":"1","last_4_cc_digits":"4321","status":"authorized","city":"new_york","user_id":"1","value":"abc","currency_id":"USD"},"op":"u","source":{"connector":"rdi_write_behind","ts_ms":1684200499566,"command":"HSET","keyspace":"transaction:*"}}'}, 'collector_time': None, 'parse_time': 0.053466796875, 'source_time': 1684200499566}, 'commands': [], 'results': [], 'job_name': 'e_transactions', 'transform_time': None, 'execution_time': None, '_parsed_key': {'key': 'transaction:1'}, '_parsed_metadata_fields': None, 'reason_rejected': 'rejected by output writer: (pymssql._pymssql.OperationalError) (245, b"Conversion failed when converting the nvarchar value \'abc\' to data type int.DB-Lib error message 20018, severity 16:\\nGeneral SQL Server error: Check messages from the SQL Server\\n")\n[SQL: \n                    MERGE [dbo].[e_transactions] AS target\n                    USING (VALUES (%(id)s)) AS source ([id]) ON (target.[id] = source.[id])\n                    WHEN NOT MATCHED BY target THEN INSERT ([id], [city], [value], [user_id], [currency_id], [status], [last_4_cc_digits]) VALUES (%(id)s, %(city)s, %(value)s, %(user_id)s, %(currency_id)s, %(status)s, %(last_4_cc_digits)s)\n                    WHEN MATCHED THEN UPDATE SET target.[city] = %(city)s, target.[value] = %(value)s, target.[user_id] = %(user_id)s, target.[currency_id] = %(currency_id)s, target.[status] = %(status)s, target.[last_4_cc_digits] = %(last_4_cc_digits)s;\n                    ]\n[parameters: {\'id\': \'1\', \'city\': \'new_york\', \'value\': \'abc\', \'user_id\': \'1\', \'currency_id\': \'USD\', \'status\': \'authorized\', \'last_4_cc_digits\': \'4321\'}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)', 'filtered': False}
1684200500069-0
message
{'key': {'key': 'transaction:1'}, 'before': {}, 'after': {'id': '1', 'last_4_cc_digits': '4321', 'status': 'authorized', 'city': 'new_york', 'user_id': '1', 'value': 'abc', 'currency_id': 'USD'}, 'connector': 'rdi_write_behind', 'server_name': None, 'db': '', 'schema': '', 'table': None, 'keyspace': 'transaction:*', 'opcode': 'u', 'metadata': {'stream': 'data:transaction:{06S}', 'stream_time': '1684200499566-0', 'collector_record': {'key': '{"key":"transaction:1"}', 'value': '{"before":{},"after":{"id":"1","last_4_cc_digits":"4321","status":"authorized","city":"new_york","user_id":"1","value":"abc","currency_id":"USD"},"op":"u","source":{"connector":"rdi_write_behind","ts_ms":1684200499566,"command":"HSET","keyspace":"transaction:*"}}'}, 'collector_time': None, 'parse_time': 0.053466796875, 'source_time': 1684200499566}, 'commands': [], 'results': [], 'job_name': 'e_transactions', 'transform_time': None, 'execution_time': None, '_parsed_key': {'key': 'transaction:1'}, '_parsed_metadata_fields': None, 'reason_rejected': 'rejected by output writer: (pymssql._pymssql.OperationalError) (245, b"Conversion failed when converting the nvarchar value \'abc\' to data type int.DB-Lib error message 20018, severity 16:\\nGeneral SQL Server error: Check messages from the SQL Server\\n")\n[SQL: \n                    MERGE [dbo].[e_transactions] AS target\n                    USING (VALUES (%(id)s)) AS source ([id]) ON (target.[id] = source.[id])\n                    WHEN NOT MATCHED BY target THEN INSERT ([id], [city], [value], [user_id], [currency_id], [status], [last_4_cc_digits]) VALUES (%(id)s, %(city)s, %(value)s, %(user_id)s, %(currency_id)s, %(status)s, %(last_4_cc_digits)s)\n                    WHEN MATCHED THEN UPDATE SET target.[city] = %(city)s, target.[value] = %(value)s, target.[user_id] = %(user_id)s, target.[currency_id] = %(currency_id)s, target.[status] = %(status)s, target.[last_4_cc_digits] = %(last_4_cc_digits)s;\n                    ]\n[parameters: {\'id\': \'1\', \'city\': \'new_york\', \'value\': \'abc\', \'user_id\': \'1\', \'currency_id\': \'USD\', \'status\': \'authorized\', \'last_4_cc_digits\': \'4321\'}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)', 'filtered': False}
